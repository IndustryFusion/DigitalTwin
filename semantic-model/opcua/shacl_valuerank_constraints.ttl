@prefix base: <https://industryfusion.github.io/contexts/ontology/v0/base/> .
@prefix opcua: <http://opcfoundation.org/UA/> .
@prefix ngsi-ld: <https://uri.etsi.org/ngsi-ld/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix shacl: <http://my.test/shacl/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix opcvrc: <http://opcfoundation.org/constraints/valueRanks> .

# Rankvalue for "any" for boolean datatype
opcvrc:ValueRankContraint_any_Boolean
    a sh:NodeShape ;
    sh:message "ValueRank Constraint: any for Boolean datatype failed" ;
    sh:or (
        # Option 1: a node that has ngsi-ld:hasValue as exactly one boolean literal
        [
            sh:property [
                sh:path ngsi-ld:hasValue ;
                sh:nodeKind sh:Literal ;
                sh:datatype xsd:boolean ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
            ]
        ]

        # Option 2: a node that has ngsi-ld:hasValueList with exactly one value,
        # where that value is either:
        #   - a blank node whose rdf:List elements are booleans, OR
        #   - the empty list ()
        [
            sh:property [
                sh:path ngsi-ld:hasValueList ;
                sh:minCount 1 ;
                sh:maxCount 1 ;

                sh:or (
                    [
                        sh:nodeKind sh:BlankNode ;
                        sh:property [
                            sh:path ( [ sh:zeroOrMorePath rdf:rest ] rdf:first ) ;
                            sh:datatype xsd:boolean ;
                        ]
                    ]
                    [
                        sh:hasValue () ;
                    ]
                ) ;
            ]
        ]
    ) .

# Rankvalue for "any" for double datatype
opcvrc:ValueRankContraint_any_Double
    a sh:NodeShape ;
    sh:message "ValueRank Constraint: any for Double datatype failed" ;
    sh:or (
        # Option 1: a node that has ngsi-ld:hasValue as exactly one double literal
        [
            sh:property [
                sh:path ngsi-ld:hasValue ;
                sh:nodeKind sh:Literal ;
                sh:datatype xsd:double ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
            ]
        ]

        # Option 2: a node that has ngsi-ld:hasValueList with exactly one value,
        # where that value is either:
        #   - a blank node whose rdf:List elements are doubles, OR
        #   - the empty list ()
        [
            sh:property [
                sh:path ngsi-ld:hasValueList ;
                sh:minCount 1 ;
                sh:maxCount 1 ;

                sh:or (
                    [
                        sh:nodeKind sh:BlankNode ;
                        sh:property [
                            sh:path ( [ sh:zeroOrMorePath rdf:rest ] rdf:first ) ;
                            sh:datatype xsd:double ;
                        ]
                    ]
                    [
                        sh:hasValue () ;
                    ]
                ) ;
            ]
        ]
    ) .
